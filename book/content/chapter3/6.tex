åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ github-script æ“ä½œåœ¨å¤åˆæ“ä½œå±•ç¤ºå·¥å…·åŒ…çš„å¼ºå¤§åŠŸèƒ½ã€‚

\mySubsubsection{3.6.1}{How to do itâ€¦}

\begin{enumerate}
\item 
ä» action.yml æ–‡ä»¶ä¸­åˆ é™¤å¸¦æœ‰ bash è„šæœ¬çš„ run æ­¥éª¤ï¼Œå¹¶æ›¿æ¢ä¸º github-script æ“ä½œï¼š

\begin{shell}
- name: Awesome github script action
  uses: actions/github-script@v6
  with:
    script: |
\end{shell}

\item 
ä½¿ç”¨å·¥å…·åŒ…è¯»å–è¾“å…¥å‚æ•°ï¼Œå‘æ—¥å¿—å†™å…¥é—®å€™è¯­ï¼Œå¹¶è®¾ç½®è¾“å‡ºå‚æ•°ï¼š

\begin{shell}
var whoToGreet = core.getInput('who-to-greet')
core.notice(`Hello ${whoToGreet}`)
core.setOutput('answer', 42)
\end{shell}

\item 
ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³è¦æ·»åŠ ä¸€äº›åŠŸèƒ½ã€‚å¦‚æœå·¥ä½œæµæ˜¯ç”±ä¸€ä¸ªissueäº‹ä»¶è§¦å‘çš„ï¼Œåˆ™æƒ³è¦åœ¨è¯¥issueæ·»åŠ ä¸€ä¸ªè¯„è®ºã€‚æ£€æŸ¥è§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶å®é™…ä¸Šæ˜¯issueï¼Œå¹¶ä¸”ä½¿ç”¨äº† github.rest.issues æ¥åˆ›å»ºä¸€ä¸ªè¯„è®ºï¼š

\begin{tcolorbox}[ breakable,colback = bashcodebg, colframe= black!50!white]
\scriptsize{
if (context.eventName === 'issues') \{ \\
\hspace*{1em}github.rest.issues.createComment(\{ \\
\hspace*{2em}issue\_number: context.issue.number, \\
\hspace*{2em}owner: context.repo.owner, \\
\hspace*{2em}repo: context.repo.repo, \\
\hspace*{2em}body: '\emoji{ğŸ‘‹} Thanks for reporting!' \\
\hspace*{1em}\}) \\
\}
}
\end{tcolorbox}

\item 
åœ¨ CI å·¥ä½œæµä¸­ï¼Œæ·»åŠ ä¸€ä¸ªè§¦å‘å™¨ï¼Œå½“æ‰“å¼€ä¸€ä¸ªæ–°é—®é¢˜æ—¶æ‰§è¡Œå·¥ä½œæµç¨‹ï¼š

\begin{shell}
on:
  issues:
    types: [opened]
\end{shell}

\item 
æäº¤å¹¶æ¨é€æ›´æ”¹ã€‚

\item 
åœ¨åº“çš„\textbf{Issues | New issue}(é—®é¢˜|æ–°é—®é¢˜)(issues/new)ä¸‹åˆ›å»ºä¸€ä¸ªæ–°issueï¼Œç»™å®ƒä¸€ä¸ªæ ‡é¢˜ï¼Œç„¶åä¿å­˜å®ƒã€‚å·¥ä½œæµå°†è¿è¡Œï¼Œå¹¶åœ¨è¯¥issueä¸Šæ·»åŠ ä¸€ä¸ªè¯„è®ºï¼Œå¦‚å›¾ 3.11 æ‰€ç¤ºï¼š

\myGraphic{0.4}{content/chapter3/images/11.png}{å›¾3.11 --- ä½¿ç”¨ github-script æ“ä½œå¯¹æ–°issueæ·»åŠ è¯„è®º}

github-script æ“ä½œæ˜¯ä½¿ç”¨å·¥å…·åŒ…çš„åŠ›é‡å¿«é€ŸåŸå‹è®¾è®¡äº‹ç‰©çš„æ–¹å¼ï¼Œè€Œä¸”ä¸éœ€è¦åˆ›å»ºå•ç‹¬æ“ä½œã€‚
\end{enumerate}

\mySubsubsection{3.6.2}{How it worksâ€¦}

github-script æ“ä½œä½¿å¾—åœ¨å·¥ä½œæµç¨‹æˆ–å¤åˆæ“ä½œä¸­å¿«é€Ÿç¼–å†™ä½¿ç”¨ GitHub API å’Œå·¥ä½œæµç¨‹è¿è¡Œä¸Šä¸‹æ–‡çš„è„šæœ¬å˜å¾—å®¹æ˜“ã€‚å®ƒä½¿ç”¨ä¸€ä¸ªåä¸º script çš„è¾“å…¥ï¼Œå…¶ä¸­åŒ…å«å¼‚æ­¥å‡½æ•°è°ƒç”¨çš„ä¸»ä½“ã€‚è¯¥æ“ä½œå°†æä¾›ä»¥ä¸‹å‚æ•°ï¼š

\begin{itemize}
\item 
github: ä¸€ä¸ªé¢„è®¤è¯çš„ octokit/rest.js å®¢æˆ·ç«¯ï¼Œå¸¦æœ‰åˆ†é¡µæ’ä»¶

\item 
context: ä¸€ä¸ªåŒ…å«å·¥ä½œæµè¿è¡Œä¸Šä¸‹æ–‡çš„å¯¹è±¡

\item 
core: å¯¹ @actions/core åŒ…çš„å¼•ç”¨ã€‚

\item 
glob: å¯¹ @actions/glob åŒ…çš„å¼•ç”¨ã€‚

\item 
io: å¯¹ @actions/io åŒ…çš„å¼•ç”¨ã€‚

\item 
exec: å¯¹ @actions/exec åŒ…çš„å¼•ç”¨ã€‚

\item 
fetch: å¯¹ node-fetch åŒ…çš„å¼•ç”¨ã€‚

\item 
require: ä¸€ä¸ªå›´ç»•æ­£å¸¸ Node.js require çš„ä»£ç†åŒ…è£…å™¨ï¼Œä»¥å¯ç”¨ç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•çš„ç›¸å¯¹è·¯å¾„ï¼Œå¹¶è¦æ±‚ npm åŒ…å®‰è£…åœ¨å½“å‰å·¥ä½œç›®å½•ä¸­
\end{itemize}

ç”±äºè„šæœ¬åªæ˜¯ä¸€ä¸ªå‡½æ•°ä½“ï¼Œè¿™äº›å€¼å°†å·²ç»å®šä¹‰ï¼Œå› æ­¤ä¸éœ€è¦å¯¼å…¥ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥åƒç¤ºä¾‹ä¸­ä½¿ç”¨ coreã€context å’Œ github é‚£æ ·ä½¿ç”¨ã€‚

è¦äº†è§£æ›´å¤šå…³äº github-script çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® \url{https://github.com/actions/github-script}ã€‚

\mySubsubsection{3.6.3}{Thereâ€™s moreâ€¦}

åœ¨ YAML æ–‡ä»¶ä¸­çš„ç¼–è¾‘å’Œè°ƒè¯•ä½“éªŒå¹¶ä¸å¥½ï¼Œå¯ä»¥åƒè¿™æ ·åœ¨æ“ä½œä¸­ä½¿ç”¨è„šæœ¬æ–‡ä»¶ï¼š

\begin{shell}
with:
  script: |
    const script = require('./path/to/script.js')
    await script({github, context, core})
\end{shell}

è¿™ç§æ–¹å¼ï¼Œå¯ä»¥å°† github-script æ“ä½œçš„ç®€å•æ€§ä¸æ›´å¥½çš„ JavaScript ç¼–å†™ä½“éªŒç»“åˆèµ·æ¥ã€‚

github-script æ“ä½œæ˜¯å¿«é€Ÿå°è¯•æŸäº›äº‹ç‰©ï¼Œå¹¶åˆ›å»ºé›†æˆæ¦‚å¿µéªŒè¯çš„å¥½æ–¹æ³•ã€‚é€šè¿‡å¤åˆæ“ä½œï¼Œå¯ä»¥é€æ¸å°†å…¶æ”¾å…¥æ˜“äºå…±äº«çš„æ„å»ºå—ä¸­ï¼Œä¹Ÿæ˜¯æ‰“åŒ…å¯é‡ç”¨åŠŸèƒ½çš„ç®€å•æ–¹æ³•ã€‚éšç€è§£å†³æ–¹æ¡ˆçš„å‘å±•ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘å°†å…¶ç§»åŠ¨åˆ° TypeScript æˆ– Docker å®¹å™¨æ“ä½œä¸­ï¼Œä»¥ä¾¿æ›´å¥½åœ°ç»´æŠ¤ã€‚











